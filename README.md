# Person Management API

Person Management API არის **RESTful** სერვისი, რომელიც უზრუნველყოფს პერსონების მართვას **(CRUD)**: ჩამატება, წაშლა, განახლება, დეტალური ნახვა და სწრაფი ძებნა. ასევე შეგვიძლია დაკავშირებული პერსონის დამატება და წაშლა.

სოლუშენი აგებულია **Clean Architecture** და **DDD** პრინციპების მიხედვით

## Features

### პერსონის მართვა
- პერსონის ნახვა დეტალურად (`GET /persons/{id}`)
- პერსონის წაშლა (`DELETE /persons/{id}`) - soft delete
- პერსონების ძებნა ფილტრაციით და ფეიჯინგით (`GET /persons`)
- პერსონის შექმნა (`POST /persons`)
- პერსონის განახლება (`PUT /persons/{id}`)
- კავშირის შექმნა პერსონებს შორის (`POST /persons/related`)
- კავშირის წაშლა პერსონებს შორის (`GET /persons/related`)

### დამატებითი ცხრილები და კავშირები
- Phone Numbers ცხრილი - პირის ტელეფონის ნომრებისა და ტიპების მართვა
- RelatedPerson - self-referencing კავშირი პერსონებს შორის (მეგობარი, ნათესავი და სხვ.)

### ძებნა და ფილტრაცია
- სწრაფი ძებნა `q` პარამეტრით
- კონკრეტული ძებნა `firstName`, `lastName`, `personalNumber` ფილტრებით (ბაზაში ინდექსებით)

## არქიტექტურა
- **Clean Architecture**
  - Api layer (მომხმარებელთან კომუნიკაცია)
  - Application layer (ბიზნეს ლოგიკა, ინტერფეისები)
  - Infrastructure layer (application ლეიერში აღწერილი ინტერფეისების იმპლემენტაციები, გარე სერვისებთან კომუნიკაცია)
  - Persistence (ბაზასთან საკომუნიკაციო ინფრასტრუქტურა)
  - Domain (დამოუკიდებელი ლეიერი, შეიცავს მთავარ ენთითიებს)
- **Domain-Driven Design (DDD)**
  - ერთი Aggregate Root - `Person`
  - მხოლოდ ერთი Repository Aggregate-ითვის, საიდანაც ხდება წვდომა დაკავშირებულ ენთითიებთან
  - CQRS pattern - query-ები და command-ები დაყოფილად
  - MediatR - CQRS-ის იმპლემენტაციისთვის
- Soft Delete რათა დათა შევინახოთ და არქივაცია გავუკეთოთ (Query Filter-ის დახმარებით, ყველგან ხელით საწერი რომ არ იყოს)
- ქეშირება Redis-ის გამოყენებით, სისწრაფის გასაზრდელად და ბაზაზე დატვირთვის შესამცირებლად (თეორიულად)
- ცენტრალიზირებული ექსეფშენების დამუშავება - GlobalExceptionHandlerMiddleware
- ცენტრალიზირებული ლოგირების სისტემა - Serilog
- ცენტრალიზირებული რიქვესტების ვალიდაცია - FluentValidation

## დოკუმენტაცია და ტესტირება
- OpenAPI დოკუმენტაცია (Swagger-ის გამოყენებით)
  - ყველა endpoint-ს აღწერილი აქვს შესაძლო სტატუს კოდები და სამაგალითო რიქვესტ / რისპონს მოდელები
- Application Layer-ის Unit ტესტები XUnit და Moq ბიბლიოთეკებით

## ავტომატიზაცია

პროექტს აქვს კონტეინერიზაციის მხარდაჭერა docker-ით

იქმნება Docker-ის იმიჯი Api-სთვის, რომლის ინსტრუქციებიც dockerfile-შია აღწერილი.

მთლიანი სისტემის მარტივად გასაშვებად, ასევე გვაქვს Docker Compose, რომელიც გამოიყენება API-ის, MSSQL-ის და Redis-ის ერთიანად და იზოლირებულად გასაშვებად.

Docker Compose-ისთვის ცვლადები .env ფაილშია გატანილი დინამიურობისთვისა და უსაფრთხოებისთვის.


## გაშვება

სისტემის გასაშვებად საკმარისია Docker Compose-ის გასტარტვა:

```bash
docker-compose up --build
```
Compose გაუშვებს:

Person Management API-ს (.NET 9) (https://localhost:8081/swagger)

MSSQL Server-ს

Redis-ის სერვერს ქეშირებისთვის
